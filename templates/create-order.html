{% extends "base.html" %}
{% block title %}Create order{% endblock %}

{% block content %}
<br>
<h1 align="center">Create order</h1>
<br>

<div class="container">
    <div class="card">
        <div class="card-header">
            <h4>Contact information</h4>
        </div>
        <div class="card-body">
            <div class="form-row">
                <div class="col">
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                          <span class="input-group-text" id="basic-addon1">First name</span>
                        </div>
                        <input type="text" class="form-control" id="name" name="first-name" required pattern="[A-Za-z]{1,32}" aria-label="FirstName" placeholder="e.g. John" aria-describedby="basic-addon1">
                    </div>
                </div>
                <div class="col">
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                          <span class="input-group-text" id="basic-addon1">Last name</span>
                        </div>
                        <input type="text" class="form-control" id="name" name="last-name" required pattern="[A-Za-z]{1,32}" aria-label="LastName" placeholder="e.g. Smith" aria-describedby="basic-addon1">
                    </div>
                </div>
            </div>
            <div class="form-row">
              <div class="col">
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                      <span class="input-group-text" id="basic-addon1">Phone number</span>
                    </div>
                    <input type="tel" id="phone" class="form-control" required pattern="[0-9]{3}-[0-9]{3}-[0-9]{4}" name="phone-number" placeholder="e.g. 888-888-8888" aria-label="PhoneNumber" aria-describedby="basic-addon1">
                </div>
            </div>
            </div>
        </div>
    </div>
</div>

<br>

<div class="container">
  <div class="card">
      <div class="card-header">
          <h4>Invoice</h4>
      </div>
      <div class="card-body">
        <table class="table table-bordered">
          <thead class="thead-light">
            <tr>
              <th scope="col">Garment</th>
              <th scope="col">Job(s)</th>
              <th scope="col" class="col-1"></th>
            </tr>
          </thead>
          <tbody id="TBody">
            <tr id="TRow">
              <td>
                <select class="custom-select">
                  {% for garment in available_garments %}
                    <option value="{{ garment.garment_name }}">{{ garment.garment_name }}</option>
                  {% endfor %}
                </select>
              </td>
              <td>Otto</td>
              <td class="NoPrint"><button type="button" class="btn btn-sm btn-danger btn-delete" onclick="BtnDel(this)">X</button></td>
            </tr>
          </tbody>
        </table>
        <div id="wrapper">
        <button type="button" class="btn btn-dark" onclick="BtnAdd()">Add garment</button>
        </div>
        <label for="basic-url">Completion date</label>
        <div class="md-form md-outline input-with-post-icon datepicker">
          <input placeholder="Select date" type="date" id="example" class="form-control">
        </div>
      </div>
  </div>
</div>

<script>
// Function to handle adding a new row
function BtnAdd() {
  // Clone the first row
  const newRow = document.getElementById("TRow").cloneNode(true);

  // Clear the selection in the cloned row
  newRow.querySelector("select").selectedIndex = 0;

  // Append the new row to the table body
  document.getElementById("TBody").appendChild(newRow);

  // Show the "X" button in all rows except the first one
  const rows = document.querySelectorAll("#TBody tr");
  rows.forEach((row, index) => {
      row.querySelector(".btn-delete").style.display = "inline-block";
  });
}

// Function to handle deleting a row
function BtnDel(button) {
  // Get the table row containing the button
  const row = button.parentNode.parentNode;

  // Remove the row from the table body
  row.remove();

  // Hide the "X" button in the last row if there's only one row left
  const rows = document.querySelectorAll("#TBody tr");
  if (rows.length === 1) {
    rows[0].querySelector(".btn-delete").style.display = "none";
  }
}

// Get the input element
const inputElement = document.getElementById("example");

// Get today's date and format it as 'YYYY-MM-DD'
const today = new Date().toISOString().split("T")[0];

// Set the 'min' attribute of the input element to today's date
inputElement.setAttribute("min", today);

  // Hide the "X" button in the last row if there's only one row left
  const rows = document.querySelectorAll("#TBody tr");
  if (rows.length === 1) {
    rows[0].querySelector(".btn-delete").style.display = "none";
  }
</script>

{% endblock %}